<% provide(:title, 'Developer') %>

<div ng-app="aquarium" ng-controller="operationTypesCtrl as planner" class='operation_types'>

  <div class='two-column' ng-if="operation_types">

    <%= render partial: 'io_form' %>
    <%= render partial: 'show_block' %>
    <%= render partial: 'steps' %>      

    <div ng-if="!initialized">Loading ...</div>

    <div class='two-column-left' ng-if="initialized">

      <div class="two-column-control">

        <ul class='op-type-list'>          

          <li ng-repeat="category in categories track by $index">

            <b ng-click="choose_category(category)">
              <span ng-if="current_category != category">&#9658;</span>
              <span ng-if="current_category == category">&#9660;</span>             
              {{category}}
              ({{category_size(category)}})
            </b>

            <ul ng-if="current_category == category" class='op-type-sublist'>
              <li ng-repeat="ot in operation_types | filter: { category: category } : true track by $index" 
                  ng-click="choose(ot)"
                  ng-class="ot_class(ot)">{{ot.name}}</li>
            </ul>

          </li>

          <li><br /></li>

          <li>
            <button class='btn btn-mini btn-primary' ng-click="new_operation_type()">New</button>
            <button class='btn btn-mini' ng-if="current_ot.id" ng-click="copy(current_ot)">Copy</button>

            <label class="btn btn-default btn-file btn-mini">
              Import <input type=file
                              id="import"
                              file="import"
                              style="display: none;"
                              custom-on-change="import_ot">
            </label>


          </li>

        </ul>

      </div>

    </div>
 
    <div class='two-column-right' ng-show="operation_types && current_ot"> 

      <ul class="nav nav-tabs">
        <li ng-class="tab('definition')"><a href="#" ng-click="set_mode('definition')">Definition</a></li>
        <li ng-class="tab('protocol')"><a href="#" ng-click="set_mode('protocol')">Protocol</a></li>
        <li ng-class="tab('cost')"><a href="#" ng-click="set_mode('cost')">Cost</a></li>
        <li ng-class="tab('documentation')"><a href="#" ng-click="set_mode('documentation')">Documentation</a></li>
        <li ng-class="tab('test')"><a href="#" ng-click="set_mode('test')">Test</a></li>
      </ul> 

      <div class="ot-part-container">
        <%= render partial: 'definition' %>
        <%= render partial: 'protocol' %>
        <%= render partial: 'cost' %>
        <%= render partial: 'documentation' %>      
        <%= render partial: 'test' %>
      </div>

    </div>

  </div>

</div>


