<%= render partial: 'templates' %>

<% provide(:title, "#{@job.id}: #{@job.path}" ) %>

<div id="krill-waiting"><%= image_tag 'waiting_animation.gif' %></div>

<div class="row-fluid">
 
  <div class='span3' id="krill-tools">

    <div id="krill-info"></div>

    <ul class="nav nav-tabs" id="tools-tab">
      <li class="active krill-tools-tab"> <a href="#history">   History     </a></li>
      <li class="krill-tools-tab">        <a href="#associations"> Associations         </a></li>
      <li class="krill-tools-tab">        <a href="#actions">   Actions     </a></li>
    </ul>

    <div class="tab-content">
      <div class="tab-pane active" id='history'> </div>
      <div class="tab-pane"        id='associations'>  
        <h4 class='krill-association-heading'>Uploads</h4>
        <div id="uploads"></div>
        <h4 class='krill-association-heading'>Inventory</h4>
        <div id="inventory"></div>
        <h4 class='krill-association-heading'>Tasks</h4>
        <div id="tasks"></div>        
      </div>
      <div class="tab-pane"        id='actions'>
        <button id="krill-note" class='krill-note-btn'>COMMENT</button>
        <button id="krill-abort" class='krill-abort-btn'>ABORT</button>
      </div>
    </div>

  </div>

  <div class="span9" id="krill-steps-ui">
      <div class="krill-carousel-btn krill-left" id='rev' class='btn'><div class='krill-arrow krill-left'>&#9664</div></div>
      <div class="" id='steps'></div>
      <div class="krill-carousel-btn krill-right" id='fwd' class='btn'><div class='krill-arrow krill-right'>&#9654</div></div>
  </div>

</div>

<script>

  // Enable Tabs
  $('#tools-tab a').click(function (e) {
    e.preventDefault();
    $(this).tab('show');
  })

  // Start steps UI
  krill = new Krill(<%= @job.id %>, '<%= @job.path %>', <%= @job.pc %>);
  krill.initialize();
  window.onresize = function(){ krill.resize(); }

  // Highlight items
  $('.aquarium-item').each(function(){
    $(this).click(function(el){
      alert("Information about item " + $(this).attr('id') + " will appear here.");
    });
  });

  // Highlight samples
  $('.aquarium-sample').each(function(){
    $(this).click(function(el){
      alert("Information about sample " + $(this).attr('id') + " will appear here.");
    });
  });

</script>