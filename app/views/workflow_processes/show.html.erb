<h1><%= @workflow_process.id %> : <%= @workflow_process.workflow.name %></h1>

<% @workflow_process.operation_containers.each do |oc| %>

  <% if oc[:jid] %>
    <% job = Job.find(oc[:jid])%>
    <% if job.status == "PENDING" 
         color = "#eff"
       elsif job.status == "COMPLETED"
         color = "#efe"
       else
        color = "#eee"
      end %>
  <% end %>

  <div class='well' style='background: <%= color %>'>

  <h2><%= oc[:operation][:id] %>: <%= oc[:operation][:name] %>: 
    <% if job %>
      Implemented by Job <%= link_to oc[:jid], job %> (<%= job.status %>)
    <% end %>
  </h2>

    <div class='row-fluid'>

      <div class='span3'>
        <h3>Inputs</h3>
        <% oc[:operation][:inputs].each do |input| %>
          <h4><%= input[:name] %></h4>
          <div class="json"><%= input[:instantiation].to_json %></div>
        <% end %>
      </div>

      <div class='span3'>
        <h3>Parameters</h3>
        <% oc[:operation][:parameters].each do |p| %>
          <h4><%= p[:name] %></h4>
          <div class="json"><%= p[:instantiation].to_json %></div>
        <% end %>
      </div>     

      <div class='span3'>
        <h3>Outputs</h3>
        <% oc[:operation][:outputs].each do |output| %>
          <h4><%= output[:name] %></h4>
          <div class="json"><%= output[:instantiation].to_json %></div>
        <% end %>
      </div>

      <div class='span3'>
        <h3>Data</h3>
        <% oc[:operation][:data].each do |d| %>
          <h4><%= d[:name] %></h4>
          <div class="json"><%= d[:instantiation].to_json %></div>
        <% end %>
      </div>

    </div>

  </div>

<% end %>

<!-- pre>
  <%= @workflow_process.state_hash %>
</pre -->

<script>
  $(".json").each(function() {
    var j = $(this).html();
    $(this).empty();
    render_json($(this),JSON.parse(j));
  });
</script>
