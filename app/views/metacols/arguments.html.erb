<% provide(:title, params[:path]) %>

<h1>Start Metacol: <%= params[:path] %></h1>

<% if @errors != "" %>

  <h4>Error</h4>

  <div id='well'>
    <p><%= @errors %></p>
  </div>

<% else %>

<h4>Arguments</h4>
<div id='argument-chooser'></div>

<br />

<h4>Group</h4>
<div id='group-chooser'></div>

<br />
<div id='button-area'></div>



  <%= render 'details' %>

<% end %>

<script>

// get arguments
var args = [];
<% @metacol.arguments.each do |a| %>
  args.push({
    name: '<%= a[:name] %>', 
    description: '<%= a[:description] %>',
    type: '<%= a[:type] %>'
  });
<% end %>

<%= render partial: 'interpreter/build_cart' %>
<%= render partial: 'interpreter/build_objects' %>
<%= render partial: 'interpreter/build_groups' %>

// run javascript ui maker thingy
ac = new ArgumentUI('<%= @sha %>',args,cart,objects);
ac.metacol = true;
ac.path = '<%= @path %>';
ac.display_form();
ac.display_groups(groups,users,'<%= current_user.login %>');

</script>
