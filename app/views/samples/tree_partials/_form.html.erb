<script type="text/ng-template" id="sample_form">

  <!-- HEADING -->

   <div class='sample-header'>
     <span  class='sample-type-name' ng-if="!sample.edit">{{sample.sample_type.name}}:</span>
     <span  class='sample-type-name' ng-if="sample.edit">
       {{sample.sample_type.name}}
       {{sample.id}}:
       </span>     
     <input class='editable' ng-model="sample.name" ></input>
     <a href="#" ng-if="!sample.edit" ng-click='remove_sample(sample)'><i class='icon-remove' ng-if="!no_remove"></i></a>
     <a href="#" ng-if="sample.edit" ng-click='view_sample(sample)'class='btn btn-mini'>Cancel</a>
     <a href="#" ng-if="sample.edit" ng-click='save_sample(sample)'class='btn btn-mini btn-primary'>Save</a>     
   </div>

   <span class='little'>{{sample}}</span>

   <!-- FIELDS -->

   <ul class='sample-tree-list'>

     <li>
       <span class="static-field-name">Description:</span>
       <i class='icon-refresh icon-white'></i> 
       <input class='editable' ng-model="sample.description"></input>
     </li>

     <li>
       <span class="static-field-name">Project:</span>
       <i class='icon-refresh icon-white'></i>  
       <input class='editable' 
              ng-model="sample.project" 
              type="text"
              projectcomplete></input>
     </li>

     <li ng-repeat='f in sample.sample_type.fields track by $index'
         ng-if="f.type == 'number' || f.type == 'string'">

       <!-- SIMPLE FIELDS -->     

       <div>
         <span class="field-name">{{f.name}}:</span>
         <i class='icon-refresh icon-white'></i> 
         <input class='editable mono' 
                ng-model="sample.fields[f.index]" 
                type="{{f.type}}" 
                step="any"></input>
       </div>

     </li>

     <li ng-repeat='f in sample.sample_type.fields track by $index'
         ng-if="f.type == 'url'">

       <div>
         <span class="field-name">{{f.name}}:</span>
         <i class='icon-refresh icon-white'></i> 
         <input class='editable' 
                ng-model="sample.fields[f.index]" 
                type="text" 
                step="any" ng-init="sample.fields[f.index] = 'http://'"></input>
       </div>

     </li>

     <li ng-repeat='f in sample.sample_type.fields track by $index'
         ng-if="f.type != 'url' && f.type != 'string' && f.type != 'number'">     

       <!-- LINKS TO OTHER SAMPLES -->

       <span class="sub-field-name">{{f.name}}:</span>

       <span ng-init="sample.fields[f.index] = { choice: 'existing', sample: '', name: f.name }">

         <i class='icon-refresh bullet-container' ng-click='toggle_new_existing(sample.fields[f.index])'></i>

         <span ng-if="sample.fields[f.index].choice == 'existing'">
           <input class='editable' ng-model='sample.fields[f.index].sample' autocomplete="f.type"></input>
         </span>

         <span ng-if="sample.fields[f.index].choice == 'new'">

           <button ng-class='new_subsample_button_class(sample.fields[f.index],st)' 
                   ng-repeat="st in f.type"
                   ng-click="new_sub_sample(sample,sample.fields[f.index],st)"
                   ng-disabled='sample.fields[f.index].sample != nil'>{{st}}</button>

           <i class='icon-remove' ng-if="sample.fields[f.index].sample" ng-click='remove_subsample(sample.fields[f.index])'></i>

           <ul class='sample-tree-list'>
             <li ng-if="sample.fields[f.index].sample" 
                 ng-include="'sample_form'" 
                 ng-init="sample = sample.fields[f.index].sample; no_remove=true"></li>
           </ul>

         </span>

       </span>

     </li>

   </ul>

</script>
